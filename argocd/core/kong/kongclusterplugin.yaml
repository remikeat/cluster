apiVersion: configuration.konghq.com/v1
kind: KongClusterPlugin
metadata:
  name: keycloak-auth
  namespace: kong
  annotations:
    kubernetes.io/ingress.class: kong
config:
  introspect_url: http://keycloak-service.keycloak.svc.cluster.local:8080/realms/users/protocol/openid-connect/token/introspect
  client_id: <path:kv/data/infra/kong#client_id>
  client_secret: <path:kv/data/infra/kong#client_secret>
plugin: auth
---
apiVersion: configuration.konghq.com/v1
kind: KongClusterPlugin
metadata:
  name: local-ip-only
  namespace: kong
  annotations:
    kubernetes.io/ingress.class: kong
config:
  allow: 192.168.0.0/24
plugin: ip-restriction
